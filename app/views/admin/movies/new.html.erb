<script type="text/javascript">
  $(function() {
    $("#video_file").addClass('form-control');
    $(".video-submit-button").click(function() { // The button class passed into multipart_uploader_form (see "Getting Started")
      new window.S3MP({
        bucket: "<%= ENV['S3_INPUT_BUCKET'] %>",
        fileInputElement: "#video_file",
        fileList: $("#video_file").get(0).files, // An array of files to be uploaded (see "Getting Started")
        onStart: function(upload) {
          console.log("File %d has started uploading", upload.key)
        },
        onComplete: function(upload) {
          var up_file = JSON.stringify(upload);
          console.log("upload --> "+up_file);
          console.log("File %d successfully uploaded", upload.key);
          $("#error_msg").hide();
          $("#success_msg").show();
          $("#success_msg").empty().append("video uploaded successfully.");
          window.location.href =  "/admin/movies/add_movie_details/"+upload.id;
          // $("#upload_video").hide();
          // $("#add_video_details").show();          
        },
        onPause: function(key) {
          console.log("File %d has been paused", key)
        },
        onCancel: function(key) {
          console.log("File upload %d was canceled", key)
        },
        onError: function(err) {
          console.log("err --> ",err);
          var er = JSON.stringify(err);
          console.log("There was an error"+er);
          $("#success_msg").hide();
          $("#progress-bar").hide();
          $("#error_msg").show();
          $("#error_msg").empty().append('Error : '+err.message);
        },
        onProgress: function(num, size, done, percent, speed) {
          var v_percent = parseFloat(percent).toFixed(2);
          $("#error_msg").hide();
          $("#success_msg").hide();
          $("#progress-bar").show();
          $("#v_u_progress_bar").css({'width': v_percent+'%'});
          $("#v_u_percent").empty().append(v_percent+'%');
          $("#on_progress").empty().append("File is "+v_percent+" percent and  done--> "+done);
          console.log("File %d is %f percent done (%f of %f total) and uploading at %s", num, v_percent, done, size, speed);
        }
      });
    });
  });
</script>
<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Admin Genres
  </h1>
</section>

<!-- Main content -->
<section class="content">
  <div class="row">
    <div class="col-xs-12">
      <div class="box">
        <div class="box-header">
          <div class="row">
            <div class="col-lg-12 col-xs-12">
              <h3 class="box-title">Add new movie details</h3>
            </div>
          </div>
        </div>
        <!-- /.box-header -->
        <div class="box-body" id="upload_video">
          <%= render 'upload_video' %>
        </div>
        <!-- /.box-body -->
      </div>
      <!-- /.box -->
    </div>
    <!-- /.col -->
  </div>
  <!-- /.row -->
</section>
<!-- /.content -->